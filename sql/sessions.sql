CREATE TABLE oradb.sessions ( dbuniquename String,  hostname String,  snapTime DateTime,  sid UInt32,  serial UInt32,  opentrn FixedString(1),  status FixedString(1),  schemaname String,  osuser String,  machine String,  program String,  type FixedString(1),  module String,  blocking_session UInt32,  event String,  classnum UInt8,  wait_time Float32,  sql_id FixedString(13),  sql_exec_start DateTime,  sql_exec_id UInt32,  logon_time DateTime,  seq UInt32,  p1 UInt64, p2 UInt64, waitobj UInt32, plsqlEnObj UInt32, plsqlEtnSubP UInt32, plsqlObj UInt32, plsqlSubP UInt32, callEt UInt32, pdml FixedString(1), pddl FixedString(1), pq FixedString(1), ecid String, sql_child_number Int32) ENGINE = MergeTree() PARTITION BY toYYYYMM(snapTime) ORDER BY (dbuniquename,snapTime) SETTINGS index_granularity=8192;
CREATE TABLE oradb.sessions_buffer AS oradb.sessions ENGINE = Buffer('oradb', 'sessions', 16, 14400, 86400, 100000, 1000000, 100000000, 1000000000);
--CREATE VIEW oradb.sessionwaitclass ( class String,  snapTime DateTime,  snapDate Date,  dbuniquename String) AS SELECT class, snapTime, snapDate, dbuniquename FROM oradb.sessions_buffer  ANY LEFT JOIN waitclass USING (classnum);
--CREATE VIEW oradb.sessionsqlid AS SELECT sql_id, snapTime, snapDate, dbuniquename, class FROM oradb.sessions_buffer  ANY LEFT JOIN waitclass USING (classnum);
