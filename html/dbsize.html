<html>
  <head>
	<meta charset="utf-8">
	<style></style>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
            google.charts.load('current', {'packages': ['corechart']});
            //google.charts.load('current', {'packages': ['table']});
            //google.charts.load('current', {'packages':['bar']});
            google.charts.setOnLoadCallback(drawIOCharts);
            //--
            function getData(query) {
                var xmlHttp = new XMLHttpRequest();
                var xmlHttpOutput;
                xmlHttp.open("POST", 'http://apex.gksm.local:18123/ckh/?database=oradb&user=oracle&password=elcaro&query=', false);
                xmlHttp.send(query);
                return xmlHttp.responseText;
            }
            //--            
            var ts;
            var te;
            var timeSpan1;
            var timeSpan2;
            //--changable
            var spanMinutes = 1440;
            var dbUniqueName = 'sefarm_prd';
            //--------------------------------------------------------------
            function preDraw() {
                te = new Date();
                ts = new Date(te.getTime() - 1000 * 60 * spanMinutes);
                timeSpan1 = ts.getFullYear() + '-' +
                        ("0" + (ts.getMonth() + 1)).slice(-2) + '-' + ("0" + ts.getDate()).slice(-2)
                        + ' ' +
                        ("0" + ts.getHours()).slice(-2) + ':' + ("0" + ts.getMinutes()).slice(-2) + ':' + ("0" + ts.getSeconds()).slice(-2)
                        ;
                timeSpan2 = te.getFullYear() + '-' +
                        ("0" + (te.getMonth() + 1)).slice(-2) + '-' + ("0" + te.getDate()).slice(-2)
                        + ' ' +
                        ("0" + te.getHours()).slice(-2) + ':' + ("0" + te.getMinutes()).slice(-2) + ':' + ("0" + te.getSeconds()).slice(-2)
                        ;
            }
		//--------------------------------------------------------------
		function ParseDBSizeData(inputData){
			var dataLines = inputData.split(/[\n]+/);
			var outData = [];
			var rowData = [];
			for (var i = 0; i < dataLines.length; i++) {
				if (dataLines[i].length > 0) {
					rowData = dataLines[i].split(/[\t]+/);
					outData.push([rowData[0], Number(rowData[1])]);
				}
			}
			return outData;
		}
        //------DBSIZE
        function drawSysStatsChart() {
			preDraw();				
			var drawRegion = "dbsize";	
            var dbSizeQuery = "select snapTime,classnum, count(1) val from sessions_buffer where dbuniquename='" +
				dbUniqueName +
                "' and snapTime >= '" + timeSpan1 + "' and snapTime <= '" + timeSpan2 + "' group by snapTime,classnum order by snapTime asc";
                //alert(waitsQuery);
            var data = new google.visualization.DataTable();
            //--add Columns
            data.addColumn('string', 'TimeStamp');
            data.addColumn('number', 'DBSize');
            //-- add Data
            data.addRows(parseDBSizeData(getData(dbSizeQuery)));
             var options = {
                 title: 'DB Size',
                 width: 1800,
                 height: 500,
                 hAxis: {textPosition: 'none'},
                 vAxis: {minValue: 0, format: '####'},
                 animation: {startup: 'true', duration: 1000},
                 bars: 'vertical',
                 //orientation : 'vertical',
                 bar: {groupWidth: '95%'},
                 legend: {position: 'right', maxLines: 3},
                 colors: legendColors,
                 isStacked: true,
                 backgroundColor: {fill: 'transparent'}
             };
             var dbSizeChart = new google.visualization.ColumnChart(document.getElementById(drawRegion));
             dbSizeChart.draw(data, options);				
		}
    </script>
  </head>

  <body onLoad=''>
	<div id="dbsize"></div>
  </body>
</html>                        
